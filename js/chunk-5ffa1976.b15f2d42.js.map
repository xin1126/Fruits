{"version":3,"sources":["webpack:///./src/views/frontend/CartFrom.vue","webpack:///./src/views/frontend/CartFrom.vue?5e9c","webpack:///./src/views/frontend/CartFrom.vue?36dd"],"names":["class","for","value","disabled","cart","ref","errors","type","$router","push","data-bs-toggle","data-bs-placement","data-bs-original-title","id","name","placeholder","rules","form","user","tel","email","address","as","payment","cols","rows","message","data","tooltip","components","Process","methods","url","Object","entries","this","storageCart","forEach","item","product_id","qty","$store","dispatch","axios","post","then","res","success","deleteCart","values","length","setTimeout","coupon","catch","$swal","title","icon","discount","status","code","num","couponPrice","final_total","updateDiscount","createOrder","order","$refs","resetForm","computed","allProducts","mounted","render","__scopeId"],"mappings":"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","file":"js/chunk-5ffa1976.b15f2d42.js","sourcesContent":["<template>\n  <section class=\"content\">\n    <div class=\"cart-banner d-flex-center text-white fs-2 mb-md-4 mb-3\">\n      <p\n        class=\"\n          bg-translucent\n          fw-bolder\n          rounded-3 rounded\n          px-lg-5\n          py-lg-3\n          px-4\n          py-2\n        \"\n      >\n        填寫訂購資料\n      </p>\n    </div>\n    <div class=\"container mb-md-5 mb-4\">\n      <div class=\"row justify-content-center\">\n        <div class=\"row\">\n          <Process class=\"col mb-3 d-sm-none\" />\n        </div>\n        <div class=\"col-lg-8\">\n          <Form v-slot=\"{ errors }\" @submit=\"cart\" ref=\"form\">\n            <div\n              class=\"\n                d-flex\n                justify-content-between\n                align-items-center\n                mb-2 mb-sm-0\n              \"\n            >\n              <button\n                type=\"button\"\n                class=\"btn btn-primary btn-hover\"\n                @click=\"$router.push('/carts')\"\n              >\n                <i class=\"bi bi-caret-left-fill\"></i>回上一步\n              </button>\n              <Process class=\"d-none d-sm-block\" />\n              <button\n                :type=\"[\n                  Object.values(errors).length ||\n                  Object.values(form.user).indexOf('') >= 0\n                    ? 'button'\n                    : 'submit',\n                ]\"\n                class=\"btn btn-primary\"\n                :class=\"[\n                  Object.values(errors).length ||\n                  Object.values(form.user).indexOf('') >= 0\n                    ? 'cursor-allowed'\n                    : 'btn-hover',\n                ]\"\n                @click=\"$router.push('/from')\"\n                ref=\"tooltip\"\n                data-bs-toggle=\"tooltip\"\n                data-bs-placement=\"bottom\"\n                :data-bs-original-title=\"[\n                  Object.values(errors).length ||\n                  Object.values(form.user).indexOf('') >= 0\n                    ? '表單欄位尚未填寫完整'\n                    : '',\n                ]\"\n              >\n                送出訂單<i class=\"bi bi-caret-right-fill\"></i>\n              </button>\n            </div>\n            <p class=\"text-danger mb-2\">*為必填欄位</p>\n            <div class=\"row mb-3\">\n              <div class=\"col-sm-6 mb-3 mb-sm-0\">\n                <label for=\"name\" class=\"form-label\"\n                  >收件人姓名<span class=\"text-danger ms-1\">*</span></label\n                >\n                <Field\n                  id=\"name\"\n                  name=\"姓名\"\n                  type=\"text\"\n                  class=\"form-control\"\n                  :class=\"{ 'is-invalid': errors['姓名'] }\"\n                  placeholder=\"請輸入姓名\"\n                  rules=\"required\"\n                  v-model=\"form.user.name\"\n                ></Field>\n                <Message name=\"姓名\" class=\"invalid-feedback\"></Message>\n              </div>\n              <div class=\"col-sm-6\">\n                <label for=\"tel\" class=\"form-label\"\n                  >收件人電話<span class=\"text-danger ms-1\">*</span></label\n                >\n                <Field\n                  id=\"tel\"\n                  name=\"電話\"\n                  type=\"tel\"\n                  class=\"form-control\"\n                  :class=\"{ 'is-invalid': errors['電話'] }\"\n                  placeholder=\"請輸入電話\"\n                  rules=\"required|min:8|max:10|numeric\"\n                  v-model=\"form.user.tel\"\n                ></Field>\n                <Message name=\"電話\" class=\"invalid-feedback\"></Message>\n              </div>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"email\" class=\"form-label\"\n                >Email<span class=\"text-danger ms-1\">*</span></label\n              >\n              <Field\n                id=\"email\"\n                name=\"email\"\n                type=\"email\"\n                class=\"form-control\"\n                :class=\"{ 'is-invalid': errors['email'] }\"\n                placeholder=\"請輸入 Email\"\n                rules=\"email|required\"\n                v-model=\"form.user.email\"\n              ></Field>\n              <Message name=\"email\" class=\"invalid-feedback\"></Message>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"address\" class=\"form-label\"\n                >收件人地址<span class=\"text-danger ms-1\">*</span></label\n              >\n              <Field\n                id=\"address\"\n                name=\"地址\"\n                type=\"text\"\n                class=\"form-control\"\n                :class=\"{ 'is-invalid': errors['地址'] }\"\n                placeholder=\"請輸入地址\"\n                rules=\"required\"\n                v-model=\"form.user.address\"\n              ></Field>\n              <Message name=\"地址\" class=\"invalid-feedback\"></Message>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"payment\" class=\"form-label\"\n                >付款方式<span class=\"text-danger ms-1\">*</span></label\n              >\n              <Field\n                as=\"select\"\n                id=\"payment\"\n                v-model=\"form.user.payment\"\n                name=\"付款方式\"\n                class=\"form-select\"\n                :class=\"{ 'is-invalid': errors['付款方式'] }\"\n                rules=\"required\"\n              >\n                <option value=\"\" disabled>請選擇付款方式</option>\n                <option value=\"信用卡\">信用卡</option>\n                <option value=\"貨到付款\">貨到付款</option>\n                <option value=\"ATM 轉帳\">ATM 轉帳</option>\n              </Field>\n              <Message name=\"付款方式\" class=\"invalid-feedback\"></Message>\n            </div>\n            <div class=\"mb-3\">\n              <label for=\"message\" class=\"form-label\">留言</label>\n              <textarea\n                name=\"留言\"\n                id=\"message\"\n                class=\"form-control\"\n                cols=\"30\"\n                rows=\"10\"\n                v-model=\"form.message\"\n              ></textarea>\n            </div>\n          </Form>\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n\n<script>\nimport { mapGetters, mapActions } from 'vuex';\nimport Process from '@/components/frontend/Process.vue';\nimport Tooltip from 'bootstrap/js/dist/tooltip';\n\nexport default {\n  data() {\n    return {\n      form: {\n        user: {\n          name: '',\n          email: '',\n          tel: '',\n          address: '',\n          payment: '',\n        },\n        message: '',\n        tooltip: '',\n      },\n    };\n  },\n  components: {\n    Process,\n  },\n  methods: {\n    ...mapActions(['updateDiscount', 'deleteCart']),\n    cart() {\n      const url = `${process.env.VUE_APP_APIURL}/api/${process.env.VUE_APP_APIPATH}/cart`;\n      Object.entries(this.storageCart).forEach((item) => {\n        const cart = {\n          product_id: item[0],\n          qty: item[1],\n        };\n        this.$store.dispatch('updateLoading', true);\n        this.axios.post(url, { data: cart })\n          .then((res) => {\n            if (res.data.success) {\n              this.deleteCart(item[0]);\n              if (Object.values(this.storageCart).length === 0) {\n                setTimeout(() => this.coupon(), 100);\n              }\n            } else {\n              setTimeout(() => this.coupon(), 100);\n            }\n          })\n          .catch(() => {\n            this.$swal({ title: '發生錯誤，請嘗試重新整理此頁面', icon: 'error' });\n            this.$store.dispatch('updateLoading', false);\n          });\n      });\n    },\n    coupon() {\n      if (this.discount.status) {\n        const url = `${process.env.VUE_APP_APIURL}/api/${process.env.VUE_APP_APIPATH}/coupon`;\n        this.$store.dispatch('updateLoading', true);\n        this.axios.post(url, { data: { code: this.discount.num } })\n          .then((res) => {\n            if (res.data.success) {\n              this.couponPrice = res.data.data.final_total;\n              this.updateDiscount({ status: 0 });\n              this.createOrder();\n            } else {\n              this.$swal({ title: res.data.message, icon: 'error' });\n            }\n          })\n          .catch(() => {\n            this.$swal({ title: '發生錯誤，請嘗試重新整理此頁面', icon: 'error' });\n            this.$store.dispatch('updateLoading', false);\n          });\n      } else {\n        this.createOrder();\n      }\n    },\n    createOrder() {\n      const url = `${process.env.VUE_APP_APIURL}/api/${process.env.VUE_APP_APIPATH}/order`;\n      const order = this.form;\n      this.$store.dispatch('updateLoading', true);\n      this.axios.post(url, { data: order })\n        .then((res) => {\n          if (res.data.success) {\n            this.$router.push('/checkout');\n            this.$swal({ title: res.data.message, icon: 'success' });\n            this.$refs.form.resetForm();\n            this.form.message = '';\n          } else {\n            this.$swal({ title: res.data.message, icon: 'error' });\n          }\n          this.$store.dispatch('updateLoading', false);\n        })\n        .catch(() => {\n          this.$swal({ title: '發生錯誤，請嘗試重新整理此頁面', icon: 'error' });\n          this.$store.dispatch('updateLoading', false);\n        });\n    },\n  },\n  computed: {\n    ...mapGetters(['storageCart', 'discount']),\n    data() {\n      const { allProducts, storageCart } = this;\n      return {\n        allProducts,\n        storageCart,\n      };\n    },\n  },\n  mounted() {\n    this.tooltip = new Tooltip(this.$refs.tooltip);\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import '@/assets/scss/all';\n.btn-hover:hover {\n  background-color: $secondary !important;\n  border: $secondary solid 1px !important;\n}\n</style>\n","import { render } from \"./CartFrom.vue?vue&type=template&id=034668ce&scoped=true\"\nimport script from \"./CartFrom.vue?vue&type=script&lang=js\"\nexport * from \"./CartFrom.vue?vue&type=script&lang=js\"\n\nimport \"./CartFrom.vue?vue&type=style&index=0&id=034668ce&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-034668ce\"\n\nexport default script","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./CartFrom.vue?vue&type=style&index=0&id=034668ce&scoped=true&lang=scss\""],"sourceRoot":""}